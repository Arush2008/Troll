<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrollOS - Advanced Psychological Warfare Platform</title>
    
    <!-- SEO and Social Media Meta Tags -->
    <meta name="description" content="Experience next-generation web-based psychological warfare. Educational purposes only! The ultimate trolling experience.">
    <meta name="keywords" content="troll, prank, web, javascript, educational, humor, trolling, gotcha">
    <meta name="author" content="The Troll Collective">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://trollos.net/">
    <meta property="og:title" content="TrollOS - You've Been Invited!">
    <meta property="og:description" content="Your friends sent you this totally legitimate website... üòà">
    <meta property="og:site_name" content="TrollOS">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://trollos.net/">
    <meta property="twitter:title" content="TrollOS - Advanced Trolling Platform">
    <meta property="twitter:description" content="Click here for a totally normal web experience! üòà">
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff6b6b">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="TrollOS">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==">
    <link rel="apple-touch-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="js/TrollEngine.js" as="script">
    <link rel="preload" href="styles.css" as="style">
    
    <!-- Security Headers (Fake ones for trolling) -->
    <meta http-equiv="X-Troll-Protection" content="maximum">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob:;">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Fake Analytics (Educational) -->
    <script>
        // Fake Google Analytics for demonstration
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'TROLL-ANALYTICS-ID', {
            'custom_map': {'custom_parameter_1': 'troll_level'}
        });
        console.log('üìä Fake Analytics: Tracking your trolling experience!');
    </script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loader"></div>
        <p>Loading amazing content... <span id="loading-percent">0</span>%</p>
        <p id="loading-status">Initializing awesome features...</p>
    </div>

    <!-- Main Content -->
    <div id="main-content" class="main-content hidden">
        <header>
            <h1 id="title">Welcome to the Best Website Ever! üéâ</h1>
            <p>Click the button below to get started!</p>
            <button id="sound-toggle" class="sound-toggle" onclick="toggleSound()" title="Toggle Sound">üîä</button>
        </header>

        <main>
            <!-- Moving Button Section -->
            <section class="troll-section moving-button-section">
                <h2>Get Your Free Prize!</h2>
                <button id="moving-button" class="troll-button">Click Me for Free Money! üí∞</button>
                <p id="button-message" class="hidden">Haha! Try again! üòú</p>
            </section>

            <!-- Fake Error Section -->
            <section class="troll-section">
                <h2>Important Update</h2>
                <button id="update-button" class="normal-button">Download Important Update</button>
            </section>

            <!-- Disappearing Content -->
            <section class="troll-section">
                <h2 id="disappearing-text">This text will disappear in 5 seconds...</h2>
                <p>Don't blink or you'll miss it!</p>
            </section>

            <!-- Fake Form -->
            <section class="troll-section">
                <h2>Win $1000 - Just Enter Your Details!</h2>
                <form id="troll-form">
                    <input type="text" placeholder="Your Name" required>
                    <input type="email" placeholder="Your Email" required>
                    <button type="submit" id="form-submit">Submit & Win!</button>
                </form>
            </section>

            <!-- Cursor Follower -->
            <div id="cursor-follower"></div>

            <!-- Hidden Blue Screen -->
            <div id="blue-screen" class="blue-screen hidden">
                <div class="blue-screen-content">
                    <h1>üòÑ SYSTEM ERROR üòÑ</h1>
                    <p>Just kidding! You've been trolled!</p>
                    <p>Your computer is perfectly fine üòâ</p>
                    <button id="close-blue-screen">Close (and stop panicking!)</button>
                </div>
            </div>

            <!-- Fake Alert Modal -->
            <div id="fake-alert" class="fake-alert hidden">
                <div class="alert-content">
                    <h2>‚ö†Ô∏è VIRUS DETECTED! ‚ö†Ô∏è</h2>
                    <p>Just kidding! üòÇ</p>
                    <p>Your computer is safe. You've been pranked!</p>
                    <button id="close-alert">I've Been Trolled!</button>
                </div>
            </div>

            <!-- Surveillance Modal -->
            <div id="surveillance-modal" class="surveillance-modal hidden">
                <div class="surveillance-content">
                    <h2>üïµÔ∏è‚Äç‚ôÇÔ∏è SURVEILLANCE DETECTED</h2>
                    <div class="fake-webcam">
                        <div class="webcam-feed">üìπ RECORDING...</div>
                        <div class="glitch-overlay"></div>
                    </div>
                    <p id="ip-message">Your IP address has been logged: 192.168.0.1</p>
                    <p id="location-message">Location detected: Mars, Solar System</p>
                    <button id="close-surveillance">Accept Surveillance</button>
                </div>
            </div>

            <!-- System Notifications -->
            <div id="notification-container" class="notification-container"></div>

            <!-- Internet Breaker -->
            <div id="internet-breaker" class="internet-breaker hidden">
                <div class="disconnected-content">
                    <div class="wifi-icon">üì∂‚ùå</div>
                    <h1>Connection Lost</h1>
                    <p>Your internet has been temporarily disconnected</p>
                    <p>Just kidding! üòÑ</p>
                    <div class="crying-emoji">üò≠</div>
                    <button id="restore-internet">Restore Connection</button>
                </div>
            </div>

            <!-- Matrix Overlay -->
            <div id="matrix-overlay" class="matrix-overlay hidden"></div>

            <!-- Multiple Cursors -->
            <div id="cursor-chaos" class="cursor-chaos hidden"></div>

            <!-- Infinite Loop Button -->
            <section class="troll-section">
                <h2>The Button That Never Works</h2>
                <button id="broken-button" class="broken-btn">Click Me (I Work, I Promise!)</button>
                <div id="broken-message" class="hidden">
                    <p>Oops! Button is broken! Try again!</p>
                    <button id="fix-button">Fix Button</button>
                </div>
            </section>

            <!-- Reverse Text -->
            <section class="troll-section">
                <h2 id="reverse-heading">Amazing Secret Message</h2>
                <p id="reverse-text">!kcart eht no era uoY .uoy gnitroll ma I ,olleH</p>
                <button id="decode-button">Decode Secret Message</button>
            </section>

            <!-- Brainless Question -->
            <section class="troll-section">
                <h2>üß† Quick Question</h2>
                <p>Are you brainless?</p>
                <div class="brainless-container-custom">
                    <button id="brainless-yes" class="brainless-btn-custom brainless-yes-custom">‚úì Yes</button>
                    <button id="brainless-no" class="brainless-btn-custom brainless-no-custom">
                        <span class="no-text">‚úó No</span>
                        <span class="yes-text">‚úì Actually... Yes!</span>
                    </button>
                </div>
                <div id="brainless-popup" class="fake-alert hidden">
                    <div class="alert-content">
                        <h2>üòè I Knew It!</h2>
                        <p>Thanks for being honest! üòà</p>
                        <button id="close-brainless">Close</button>
                    </div>
                </div>
            </section>

            <!-- Fake AI Chatbox -->
            <section class="troll-section">
                <h2>ü§ñ AI Assistant (Beta)</h2>
                <div id="chatbox" class="chatbox">
                    <div id="chat-messages" class="chat-messages">
                        <div class="ai-message">Hello! I'm your AI assistant. How can I help you today?</div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" id="chat-input" placeholder="Ask me anything..." maxlength="100">
                        <button id="chat-send">Send</button>
                    </div>
                </div>
            </section>

            <!-- Fake File Explorer -->
            <section class="troll-section">
                <h2>üìÇ Your Files</h2>
                <div id="file-explorer" class="file-explorer">
                    <div class="file-item" data-file="passwords.txt">
                        üìÑ passwords.txt
                    </div>
                    <div class="file-item" data-file="DO_NOT_OPEN.exe">
                        ‚ö†Ô∏è DO_NOT_OPEN.exe
                    </div>
                    <div class="file-item" data-file="homework_folder">
                        üìÅ homework_folder
                    </div>
                    <div class="file-item" data-file="secret_diary.txt">
                        üìù secret_diary.txt
                    </div>
                    <div class="file-item" data-file="virus_scanner.exe">
                        üõ°Ô∏è virus_scanner.exe
                    </div>
                </div>
            </section>

            <!-- Fake Terminal -->
            <section class="troll-section">
                <h2>üíª Terminal Access</h2>
                <div id="terminal" class="terminal">
                    <div id="terminal-output" class="terminal-output">
                        <div class="terminal-line">Welcome to TrollOS Terminal v2.0</div>
                        <div class="terminal-line">Type 'help' for available commands...</div>
                    </div>
                    <div class="terminal-input-line">
                        <span class="terminal-prompt">user@trollsite:~$ </span>
                        <input type="text" id="terminal-input" class="terminal-input" autocomplete="off">
                    </div>
                </div>
            </section>

            <!-- Gaslighting Form -->
            <section class="troll-section">
                <h2>Contact Form (Totally Normal)</h2>
                <form id="gaslight-form" class="gaslight-form">
                    <input type="text" id="gaslight-name" placeholder="Your Name" class="gaslight-input">
                    <input type="email" id="gaslight-email" placeholder="Your Email" class="gaslight-input">
                    <div class="button-container">
                        <button type="submit" id="yes-btn" class="gaslight-btn">Yes</button>
                        <button type="button" id="no-btn" class="gaslight-btn">No</button>
                    </div>
                </form>
            </section>

            <!-- Trolling Games Section -->
            <section class="troll-section">
                <h2>üéÆ Mini Games (Totally Fair!)</h2>
                <div class="games-container">
                    <div class="game-card" onclick="showGame('catch-button')">
                        <h3>üéØ Catch the Button</h3>
                        <p>Click the moving target 10 times to win!</p>
                    </div>
                    <div class="game-card" onclick="showGame('memory-game')">
                        <h3>üß† Memory Game</h3>
                        <p>Remember the sequence... if you can!</p>
                    </div>
                    <div class="game-card" onclick="showGame('typing-test')">
                        <h3>‚å®Ô∏è Typing Test</h3>
                        <p>Type the words as fast as you can!</p>
                    </div>
                    <div class="game-card" onclick="showGame('reaction-time')">
                        <h3>‚ö° Reaction Time</h3>
                        <p>Test your lightning reflexes!</p>
                    </div>
                </div>
            </section>

            <!-- Game Modals -->
            <div id="game-modal" class="game-modal hidden">
                <div class="game-content">
                    <button id="close-game" class="close-game-btn">‚úñ</button>
                    
                    <!-- Catch the Button Game -->
                    <div id="catch-button-game" class="game-screen hidden">
                        <h2>üéØ Catch the Button</h2>
                        <p>Score: <span id="catch-score">0</span>/10</p>
                        <div class="catch-game-area">
                            <button id="catch-target" class="catch-target">Click Me!</button>
                        </div>
                        <p id="catch-message">Click the button 10 times to win!</p>
                    </div>

                    <!-- Memory Game -->
                    <div id="memory-game-screen" class="game-screen hidden">
                        <h2>üß† Memory Game</h2>
                        <p>Level: <span id="memory-level">1</span></p>
                        <div id="memory-grid" class="memory-grid">
                            <!-- Grid will be generated by JS -->
                        </div>
                        <p id="memory-message">Watch the sequence and repeat it!</p>
                    </div>

                    <!-- Typing Test -->
                    <div id="typing-test-screen" class="game-screen hidden">
                        <h2>‚å®Ô∏è Typing Test</h2>
                        <p>Score: <span id="typing-score">0</span>/5</p>
                        <div class="typing-area">
                            <div id="typing-target-word" class="typing-target">hello</div>
                            <input type="text" id="typing-input" placeholder="Type the word above">
                        </div>
                        <p id="typing-message">Type 5 words correctly to win!</p>
                    </div>

                    <!-- Reaction Time Game -->
                    <div id="reaction-time-screen" class="game-screen hidden">
                        <h2>‚ö° Reaction Time Test</h2>
                        <div id="reaction-area" class="reaction-area">
                            <div id="reaction-circle" class="reaction-circle">Wait for GREEN...</div>
                        </div>
                        <p id="reaction-message">Click when the circle turns GREEN!</p>
                        <p>Best Time: <span id="best-time">---</span>ms</p>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer>
                <p>You've been successfully trolled! üé≠</p>
                <p>Hope you had fun! This website is harmless and just for laughs.</p>
                <button id="restart-button">Restart the Trolling!</button>
            </footer>
        </main>
    </div>

    <!-- Advanced Troll System Scripts -->
    <script src="js/TrollEngine.js"></script>
    <script src="js/TrollFeatures.js"></script>
    <script src="js/AdvancedTrollFeatures.js"></script>
    <script src="js/CompleteTrollFeatures.js"></script>
    
    <!-- Legacy Script (Being Modernized) -->
    <script src="script.js"></script>
    
    <!-- Initialize Advanced Troll System -->
    <script>
        // Initialize the advanced troll engine when page loads
        let trollEngine;
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üé≠ Initializing Advanced Troll System...');
            
            // Wait a bit for all legacy code to load
            setTimeout(() => {
                try {
                    trollEngine = new TrollEngine();
                    console.log('üöÄ Advanced Troll System Online!');
                    
                    // Add settings button after engine is ready
                    if (!trollEngine.getFeature('settingsPanel')) {
                        trollEngine.registerFeature('settingsPanel', new SettingsPanelTroll(trollEngine));
                    }
                    
                } catch (error) {
                    console.error('Troll Engine Failed to Initialize:', error);
                    // Fallback to basic trolling if advanced system fails
                    console.log('ü§° Falling back to basic troll mode');
                }
            }, 1000);
        });
        
        // Expose troll engine for debugging (if dev mode is unlocked)
        window.getTrollEngine = () => {
            if (trollEngine && trollEngine.isDebugMode()) {
                return trollEngine;
            }
            console.log('üîí Access denied. Unlock dev mode first!');
            return null;
        };
        
        // PWA Installation Handler
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('üì± PWA Install prompt available');
            e.preventDefault();
            deferredPrompt = e;
            
            // Show custom install banner after user gets trolled a bit
            setTimeout(() => {
                showPWAInstallBanner();
            }, 30000);
        });
        
        function showPWAInstallBanner() {
            const banner = document.createElement('div');
            banner.className = 'pwa-install-banner';
            banner.innerHTML = `
                <h4>üì± Install TrollOS App!</h4>
                <p>Get the full trolling experience with our PWA! Works offline too! üòà</p>
                <button id="pwa-install-yes">Install App</button>
                <button id="pwa-install-no">No Thanks</button>
                <button id="pwa-install-close">√ó</button>
            `;
            
            document.body.appendChild(banner);
            
            // Install button
            banner.querySelector('#pwa-install-yes').addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    
                    if (outcome === 'accepted') {
                        console.log('üì± PWA Installation accepted');
                        trollEngine?.showNotification('Welcome to TrollOS App! üì±', 'update');
                    } else {
                        console.log('üì± PWA Installation declined');
                        trollEngine?.showNotification('App rejected! We\'ll ask again later! üòà', 'virus');
                    }
                    
                    deferredPrompt = null;
                }
                banner.remove();
            });
            
            // No thanks button (troll response)
            banner.querySelector('#pwa-install-no').addEventListener('click', () => {
                trollEngine?.showNotification('Too bad! We\'ll ask again in 30 seconds! üîÑ', 'virus');
                banner.remove();
                
                setTimeout(() => {
                    if (!document.querySelector('.pwa-install-banner')) {
                        showPWAInstallBanner();
                    }
                }, 30000);
            });
            
            // Close button
            banner.querySelector('#pwa-install-close').addEventListener('click', () => {
                banner.remove();
            });
        }
        
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    console.log('ü§ñ Service Worker registered successfully:', registration.scope);
                    
                    // Handle service worker updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // New version available
                                console.log('üîÑ New TrollOS version available!');
                                
                                if (trollEngine) {
                                    trollEngine.showNotification('New TrollOS update available! Refresh to get more trolling features! üîÑ', 'update');
                                }
                            }
                        });
                    });
                    
                    // Message channel for service worker communication
                    navigator.serviceWorker.addEventListener('message', (event) => {
                        console.log('üí¨ Message from Service Worker:', event.data);
                        
                        if (event.data && event.data.type === 'TROLL_NOTIFICATION') {
                            trollEngine?.showNotification(event.data.message, 'virus');
                        }
                    });
                    
                } catch (error) {
                    console.log('‚ùå Service Worker registration failed:', error);
                }
            });
        }
        
        // Push Notifications (Fake subscription for demo)
        async function subscribeToPushNotifications() {
            if ('Notification' in window && 'serviceWorker' in navigator) {
                const permission = await Notification.requestPermission();
                
                if (permission === 'granted') {
                    console.log('üîî Push notifications enabled');
                    trollEngine?.showNotification('Push notifications enabled! Prepare for surprise trolling! üì≤', 'update');
                    
                    // Fake subscription (no real server)
                    setTimeout(() => {
                        new Notification('TrollOS Test Notification! üé≠', {
                            body: 'This is just a test... or is it? üòà',
                            tag: 'troll-test'
                        });
                    }, 5000);
                } else {
                    console.log('üîî Push notifications denied');
                    trollEngine?.showNotification('Notifications blocked! We\'ll find other ways to annoy you! üòà', 'virus');
                }
            }
        }
        
        // Auto-request notifications after user interaction
        document.addEventListener('click', () => {
            if (Math.random() < 0.1 && trollEngine?.getTrollLevel() > 20) {
                subscribeToPushNotifications();
            }
        }, { once: true });
    </script>
</body>
</html>